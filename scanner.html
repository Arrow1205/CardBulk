<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@300;400;600;700;800;900&family=Barlow:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700;800&family=Fugaz+One&display=swap" rel="stylesheet">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="CardVault">
<meta name="theme-color" content="#0c0c0e">
<link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAMAEBAAAAEAIABoBAAANgAAAICAgAAABACAAoAkAAMYAAAA=">
<link rel="stylesheet" href="assets/app.css">
<title>CardVault ‚Äî Ajouter</title>
</head>
<body>

<!-- SCANNER -->
<div class="page" id="page-scanner">
  <div class="page-inner">
    <div class="scanner-hdr"><div class="scanner-title">Ajouter</div><div class="scanner-sub">Scanne ou uploade ta carte</div></div>
    <div style="padding:0 20px;">
      <div class="side-tabs">
        <div class="side-tab active" id="add-tab-recto" onclick="switchAddSide('recto')">Recto</div>
        <div class="side-tab" id="add-tab-verso" onclick="switchAddSide('verso')">Verso</div>
      </div>
      <div id="add-recto-zone">
        <div class="photo-upload" id="photo-upload-zone"><div class="scan-frame-overlay"><div class="sf-corner sf-tl"></div><div class="sf-corner sf-tr"></div><div class="sf-corner sf-bl"></div><div class="sf-corner sf-br"></div><div class="scan-line"></div></div>
          <input type="file" id="card-photo-lib" accept="image/*" style="display:none" onchange="handlePhoto(this,'recto')">
          <input type="file" id="card-photo-cam" accept="image/*" capture="environment" style="display:none" onchange="handlePhoto(this,'recto')">
          <div id="photo-preview-wrap" style="display:none;position:absolute;inset:0;" onclick="document.getElementById('card-photo-lib').click()">
            <img id="photo-preview-img" style="width:100%;height:100%;object-fit:cover;">
            <div style="position:absolute;bottom:8px;right:8px;background:rgba(0,0,0,.6);border-radius:99px;padding:3px 10px;font-size:9px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;">Changer</div>
          </div>
          <div id="photo-placeholder-ui"><div style="font-size:28px;"></div>
            <div class="photo-btns">
              <button class="photo-btn" type="button" onclick="document.getElementById('card-photo-cam').click()">Cam√©ra</button>
              <button class="photo-btn" type="button" onclick="document.getElementById('card-photo-lib').click()">Biblioth√®que</button>
            </div>
          </div>
        </div>
        <button class="crop-btn" id="crop-btn" style="display:none;" onclick="openCrop('recto')">Recadrer</button>
        <button class="crop-btn" id="ocr-btn" style="margin-top:10px;" type="button" onclick="ocrCard()">Analyser (OCR)</button>
</div>
      <div id="add-verso-zone" style="display:none;">
        <div class="photo-upload" id="photo-upload-zone-v">
          <input type="file" id="card-photo-lib-v" accept="image/*" style="display:none" onchange="handlePhoto(this,'verso')">
          <input type="file" id="card-photo-cam-v" accept="image/*" capture="environment" style="display:none" onchange="handlePhoto(this,'verso')">
          <div id="photo-preview-wrap-v" style="display:none;position:absolute;inset:0;" onclick="document.getElementById('card-photo-lib-v').click()">
            <img id="photo-preview-img-v" style="width:100%;height:100%;object-fit:cover;">
            <div style="position:absolute;bottom:8px;right:8px;background:rgba(0,0,0,.6);border-radius:99px;padding:3px 10px;font-size:9px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;">Changer</div>
          </div>
          <div id="photo-placeholder-ui-v"><div style="font-size:28px;"></div>
            <div class="photo-btns">
              <button class="photo-btn" type="button" onclick="document.getElementById('card-photo-cam-v').click()">Cam√©ra</button>
              <button class="photo-btn" type="button" onclick="document.getElementById('card-photo-lib-v').click()">Biblioth√®que</button>
            </div>
          </div>
        </div>
        <button class="crop-btn" id="crop-btn-v" style="display:none;" onclick="openCrop('verso')">Recadrer verso</button>
      </div>
      <div style="height:14px;"></div>
      <div class="form-group"><label class="form-label">Pr√©nom</label><input class="form-input" id="f-prenom" type="text" placeholder="Kylian" autocomplete="off"></div>
      <div class="form-group"><label class="form-label">Nom</label><input class="form-input" id="f-nom" type="text" placeholder="Mbapp√©" autocomplete="off"></div>
      <div class="form-group"><label class="form-label">Sport</label>
        <div class="sport-select-wrap"><span id="f-sport-icon" class="sport-icon"></span><select class="form-select" id="f-sport" onchange="onSportChange();updateSportIcon()">
          <option value="">S√©lectionner</option>
          <option value="football">Football / Soccer</option>
          <option value="basketball">Basketball</option>
          <option value="baseball">Baseball</option>
          <option value="nfl">NFL</option>
          <option value="nhl">NHL</option>
          <option value="tennis">Tennis</option>
          <option value="f1">Formule 1</option>
          <option value="autre">Autre</option>
          <option value="marvel">Marvel</option>
          <option value="pokemon">Pok√©mon</option>
        </select></div>
      </div>
      <div class="form-group" id="club-group" style="display:none;">
        <label class="form-label">Club / √âquipe</label>
        <div class="club-search-wrap">
          <input class="form-input" id="f-club-search" type="text" placeholder="Rechercher un club‚Ä¶ (ex: Ars)" oninput="clubSearch(this.value,'f')" onfocus="clubSearch(this.value,'f')" autocomplete="off">
          <div class="club-dropdown" id="f-club-dropdown"></div>
        </div>
        <div id="sel-club-disp" style="display:none;margin-top:9px;align-items:center;gap:8px;"></div>
        <button class="club-create-btn" id="club-create-show" style="display:none;" onclick="showCreateClubForm('f')"></button>
        <div id="club-create-form" style="display:none;margin-top:8px;">
          <input class="form-input" id="new-club-name" type="text" placeholder="Nom du club" style="margin-bottom:6px;">
          <input class="form-input" id="new-club-full" type="text" placeholder="Nom complet" style="margin-bottom:6px;">
          <input class="form-input" id="new-club-emoji" type="text" placeholder="Emoji" style="margin-bottom:6px;width:70px;">
          <button class="btn-primary" style="padding:9px;" onclick="createClub('f')">Cr√©er</button>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Num√©rot√©e</label>
        <div style="display:flex;gap:7px;align-items:center;">
          <div class="toggle-row" style="flex:1;"><button class="toggle-btn on" id="num-non" onclick="toggleNum(false)">Non</button><button class="toggle-btn" id="num-oui" onclick="toggleNum(true)">Oui</button></div>
          <input class="form-input" id="f-num" type="text" placeholder="/25" style="width:76px;display:none;">
        </div>
      </div>
      <div class="form-group"><label class="form-label">Sp√©cificit√©s</label><div class="toggle-row"><button class="toggle-btn" id="tog-auto" onclick="toggleTag('auto')">Auto</button><button class="toggle-btn" id="tog-patch" onclick="toggleTag('patch')">Patch</button><button class="toggle-btn" id="tog-rookie" onclick="toggleTag('rookie')">Rookie</button></div></div>

      <!-- MARQUE -->
      <div class="form-group"><label class="form-label">Marque</label>
        <select class="form-select" id="f-marque" onchange="onMarqueChange('f')">
          <option value="">S√©lectionner</option>
          <option value="Topps">Topps</option>
          <option value="Panini">Panini</option>
          <option value="Leaf">Leaf</option>
          <option value="Futera">Futera</option>
          <option value="Daka">Daka</option>
          <option value="Autre">Autre</option>
        </select>
      </div>
      <!-- ANN√âE -->
      <div class="form-group"><label class="form-label">Ann√©e</label>
        <select class="form-select" id="f-annee">
          <option value="">S√©lectionner</option>
        </select>
      </div>
      <!-- COLLECTION/SET cascade -->
      <div class="form-group" id="f-set-group" style="display:none;"><label class="form-label">Collection / Set</label>
        <select class="form-select" id="f-set"></select>
      </div>

      <div class="form-group"><label class="form-label">Dossier</label><select class="form-select" id="f-collection"></select></div>
      <div id="new-coll-wrap" style="display:none;margin-top:7px;"><input class="form-input" id="f-new-coll" type="text" placeholder="Nom de la collection"></div>
      <div class="form-group"><label class="form-label">Prix estim√© (‚Ç¨)</label><input class="form-input" id="f-price" type="number" placeholder="0.00" step="0.01" min="0"></div>
      <div class="form-group"><label class="form-label">Notes</label><textarea class="form-input" id="f-notes" rows="3" placeholder="√âtat, remarques‚Ä¶"></textarea></div>
      <button class="btn-primary" id="save-card-btn" onclick="saveCard()">Enregistrer la carte</button>
      <div style="height:22px;"></div>
    </div>
  </div>
</div>



<!-- TABBAR -->
<div class="tabbar">
  <button class="tab-btn active" onclick="navigate('home')" id="tab-home">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>Accueil
  </button>
  <button class="tab-btn scan-btn" onclick="navigate('scanner')" id="tab-scanner">
    <div class="scan-circle"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" width="22" height="22" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg></div>
  </button>
  <button class="tab-btn" onclick="navigate('collection')" id="tab-collection">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/></svg>Collection
  </button>
</div>


<!-- CARD DETAIL -->
<div class="card-detail" id="card-detail">
  <div class="card-detail-hdr">
    <button class="back-btn" onclick="closeDetail()"><svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg></button>
    <div style="display:flex;gap:8px;">
      
      <button class="detail-fav-btn" id="detail-fav-btn" onclick="toggleFav()"></button>
    </div>
  </div>
  <div class="card-3d-scene card-animated" id="card-3d-scene">
    <!-- Big name BG text (no photo) -->
    <div class="card-bg-name-text" id="card-bg-name-text" style="display:none;"></div>
    <!-- Flip container -->
    <div class="card-flip-container" id="card-flip-container">
      <div class="card-flip-inner" id="card-flip-inner">
        <div class="card-face" id="card-face-front">
          <div class="card-3d-content card-3d-placeholder" id="card-3d-content"><span style="font-size:40px;opacity:.25;">üÉè</span></div>
        </div>
        <div class="card-face card-face-back" id="card-face-back">
          <div class="card-3d-content card-3d-placeholder" id="card-3d-content-back"><span style="font-size:40px;opacity:.25;"></span></div>
        </div>
      </div>
    </div>
    <button class="flip-btn" id="flip-btn" onclick="flipCard()" style="display:none;" title="Retourner la carte"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg></button>
  </div>
  <div class="card-detail-bottom">
    <div class="player-identity">
      <div>
        <div class="player-first" id="detail-prenom"></div>
        <div class="player-last" id="detail-nom" onclick="openPlayerStats()">‚Äî</div>
        <div class="player-meta">
          <span id="detail-flag" class="player-flag" style="display:none;"></span>
          <span id="detail-club-logo-wrap" onclick="filterByClub(db.cards.find(x=>String(x.id)===String(curCardId))?.club||'')" style="cursor:pointer;"></span>
          <span class="player-club" id="detail-club-n" onclick="filterByClub(db.cards.find(x=>String(x.id)===String(curCardId))?.club||'')" style="cursor:pointer;"></span>
          <span class="sep" id="detail-sep" style="display:none;"></span>
          <span class="player-sport-label" id="detail-sport-label"></span>
        </div>
      </div>
      <div class="player-right" style="display:none;"><div id="detail-num" style="display:none;"></div><div id="detail-badges"></div></div>
    </div>
    <div class="chips-grid" id="chips-grid">
      <div class="chip chip-marque"><div class="chip-label">Marque</div><div class="chip-val" id="d-marque">‚Äî</div></div>
      <div class="chip"><div class="chip-label">Ann√©e</div><div class="chip-val" id="d-annee">‚Äî</div></div>
      <div class="chip"><div class="chip-label">Set</div><div class="chip-val" id="d-set" style="font-size:13px;">‚Äî</div></div>
      <div class="chip" id="chip-tags-row"><div class="chip-label">Sp√©cificit√©s</div><div class="chip-val" id="d-tags-val" style="display:flex;gap:4px;flex-wrap:wrap;align-items:center;padding-top:2px;font-size:12px;">‚Äî</div></div>
      <div class="chip"><div class="chip-label">Dossier</div><div class="chip-val" id="d-coll">‚Äî</div></div>
      <div class="chip"><div class="chip-label">Prix</div><div class="chip-val price-val" id="d-price">‚Äî</div></div>
    </div>
    <div class="detail-notes-wrap" id="d-notes-wrap" style="display:none;">
      <div class="detail-notes-label">Notes</div>
      <div class="detail-notes-val" id="d-notes-val"></div>
    </div>
    <div class="detail-actions">
      <button class="btn-secondary" onclick="editCurrentCard()">Modifier</button>
      <button class="btn-accent" onclick="openPlayerStats()">Stats Joueur</button>
    </div>
  </div>
</div>


<!-- COLL VIEW -->
<div class="coll-view" id="coll-view">
  <div class="coll-view-hdr">
    <button class="back-btn" onclick="closeCollView()"><svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg></button>
    <div class="coll-view-title" id="coll-view-title">Dossier</div>
    <div class="btn-icon" onclick="deleteCurrentFolder()"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/></svg></div>
  </div>
  <div class="coll-view-body"><div class="colls-grid" id="folder-cards-grid"></div></div>
</div>


<!-- BULK -->
<div class="bulk-bar" id="bulk-bar">
  <button class="btn-secondary" style="flex:0 0 auto;padding:9px 13px;" onclick="cancelBulk()">Annuler</button>
  <select class="form-select" id="bulk-dest" style="flex:1;"></select>
  <button class="btn-accent" style="flex:0 0 auto;padding:9px 13px;" onclick="executeBulk()"></button>
</div>


<!-- EDIT SHEET -->
<div class="sheet-overlay" id="edit-sheet" onclick="closeSheet('edit-sheet',event)">
  <div class="sheet" onclick="event.stopPropagation()">
    <div class="sheet-handle"></div>
    <div class="sheet-title">Modifier</div>
    <button class="sheet-delete-btn" onclick="deleteCurrentCard()">Supprimer</button>
    <div class="side-tabs">
      <div class="side-tab active" id="edit-tab-recto" onclick="switchEditSide('recto')">Recto</div>
      <div class="side-tab" id="edit-tab-verso" onclick="switchEditSide('verso')">Verso</div>
    </div>
    <div id="edit-recto-zone" style="margin-bottom:10px;">
      <div class="photo-upload" id="edit-photo-zone" style="max-height:180px;">
        <input type="file" id="e-photo-lib" accept="image/*" style="display:none" onchange="handleEditPhoto(this,'recto')">
        <div id="e-preview-wrap" style="display:none;position:absolute;inset:0;" onclick="document.getElementById('e-photo-lib').click()">
          <img id="e-preview-img" style="width:100%;height:100%;object-fit:cover;">
          <div style="position:absolute;bottom:8px;right:8px;background:rgba(0,0,0,.6);border-radius:99px;padding:3px 10px;font-size:9px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;">Changer</div>
        </div>
        <div id="e-placeholder"><div style="font-size:22px;"></div>
          <div class="photo-btns">
            <button class="photo-btn" type="button" onclick="document.getElementById('e-photo-lib').click()">Biblioth√®que</button>
          </div>
        </div>
      </div>
      <button class="crop-btn" id="e-crop-btn" style="display:none;margin-bottom:8px;" onclick="openCrop('edit-recto')">Recadrer</button>
    </div>
    <div id="edit-verso-zone" style="display:none;margin-bottom:10px;">
      <div class="photo-upload" id="edit-photo-zone-v" style="max-height:180px;">
        <input type="file" id="e-photo-lib-v" accept="image/*" style="display:none" onchange="handleEditPhoto(this,'verso')">
        <div id="e-preview-wrap-v" style="display:none;position:absolute;inset:0;" onclick="document.getElementById('e-photo-lib-v').click()">
          <img id="e-preview-img-v" style="width:100%;height:100%;object-fit:cover;">
          <div style="position:absolute;bottom:8px;right:8px;background:rgba(0,0,0,.6);border-radius:99px;padding:3px 10px;font-size:9px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;">Changer</div>
        </div>
        <div id="e-placeholder-v"><div style="font-size:22px;"></div>
          <div class="photo-btns">
            <button class="photo-btn" type="button" onclick="document.getElementById('e-photo-lib-v').click()">Biblioth√®que</button>
          </div>
        </div>
      </div>
      <button class="crop-btn" id="e-crop-btn-v" style="display:none;margin-bottom:8px;" onclick="openCrop('edit-verso')">Recadrer verso</button>
    </div>
    <div class="form-group"><label class="form-label">Pr√©nom</label><input class="form-input" id="e-prenom" type="text"></div>
    <div class="form-group"><label class="form-label">Nom</label><input class="form-input" id="e-nom" type="text"></div>
    <div class="form-group"><label class="form-label">Sport</label>
      <select class="form-select" id="e-sport" onchange="onEditSportChange()">
        <option value="">S√©lectionner</option>
        <option value="football">Football</option>
        <option value="basketball">Basketball</option>
        <option value="baseball">Baseball</option>
        <option value="nfl">NFL</option>
        <option value="nhl">NHL</option>
        <option value="tennis">Tennis</option>
        <option value="f1">F1</option>
        <option value="autre">Autre</option>
      </select>
    </div>
    <div class="form-group" id="e-club-group" style="display:none;">
      <label class="form-label">Club / √âquipe</label>
      <div class="club-search-wrap">
        <input class="form-input" id="e-club-search" type="text" placeholder="Rechercher un club‚Ä¶" oninput="clubSearch(this.value,'e')" onfocus="clubSearch(this.value,'e')" autocomplete="off">
        <div class="club-dropdown" id="e-club-dropdown"></div>
      </div>
    </div>
    <div class="form-group"><label class="form-label">Num√©rot√©e (/X)</label><input class="form-input" id="e-num" type="text" placeholder="/25"></div>
    <div class="form-group"><label class="form-label">Sp√©cificit√©s</label><div class="toggle-row"><button class="toggle-btn" id="e-tog-auto" onclick="eTogTag('auto')">Auto</button><button class="toggle-btn" id="e-tog-patch" onclick="eTogTag('patch')">Patch</button><button class="toggle-btn" id="e-tog-rookie" onclick="eTogTag('rookie')">Rookie</button></div></div>
    <div class="form-group"><label class="form-label">Marque</label>
      <select class="form-select" id="e-marque" onchange="onMarqueChange('e')">
        <option value="">S√©lectionner</option>
        <option value="Topps">Topps</option>
        <option value="Panini">Panini</option>
        <option value="Leaf">Leaf</option>
        <option value="Futera">Futera</option>
        <option value="Daka">Daka</option>
        <option value="Autre">Autre</option>
      </select>
    </div>
    <div class="form-group"><label class="form-label">Ann√©e</label>
      <select class="form-select" id="e-annee"></select>
    </div>
    <div class="form-group" id="e-set-group" style="display:none;"><label class="form-label">Collection / Set</label>
      <select class="form-select" id="e-set"></select>
    </div>
    <div class="form-group"><label class="form-label">Dossier</label>
      <select class="form-select" id="e-collection" onchange="onEditCollChange()"></select>
    </div>
    <div id="e-new-coll-wrap" style="display:none;margin-bottom:13px;"><input class="form-input" id="e-new-coll" type="text" placeholder="Nom du nouveau dossier"></div>
    <div class="form-group"><label class="form-label">Prix estim√© (‚Ç¨)</label><input class="form-input" id="e-price" type="number" placeholder="0.00" step="0.01" min="0"></div>
    <div class="form-group"><label class="form-label">Notes</label><textarea class="form-input" id="e-notes" rows="3"></textarea></div>
    <button class="btn-primary" onclick="saveEdit()">Sauvegarder</button>
  </div>
</div>


<!-- PLAYER STATS -->
<div class="sheet-overlay" id="player-sheet" onclick="closeSheet('player-sheet',event)">
  <div class="sheet" onclick="event.stopPropagation()">
    <div class="sheet-handle"></div>
    <div id="player-ai-content"><div class="ai-loading"><div class="ai-spin"></div>Recherche‚Ä¶</div></div>
  </div>
</div>


<!-- FOLDER SHEET -->
<div class="sheet-overlay" id="folder-sheet" onclick="closeSheet('folder-sheet',event)">
  <div class="sheet" onclick="event.stopPropagation()">
    <div class="sheet-handle"></div><div class="sheet-title">Nouveau dossier</div>
    <div class="form-group"><label class="form-label">Nom</label><input class="form-input" id="new-folder-name" type="text" placeholder="ex: Rookies 2024"></div>
    <div class="form-group"><label class="form-label">Ic√¥ne</label>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)">‚≠ê</span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)"></span><span style="cursor:pointer;font-size:22px;" onclick="selEmoji(this)">üÉè</span>
      </div>
    </div>
    <button class="btn-primary" onclick="createFolder()">Cr√©er le dossier</button>
  </div>
</div>


<!-- CROP -->
<div class="crop-overlay" id="crop-overlay">
  <div class="crop-label" id="crop-label">Ajuste le cadrage</div>
  <div class="crop-wrap">
    <canvas id="crop-canvas" class="crop-canvas"></canvas>
    <img id="crop-img" class="crop-img" draggable="false" style="display:none;">
    <div class="crop-frame"></div>
</div>
  <div class="crop-hint">Glisse pour repositionner</div>
  <div class="crop-controls" id="crop-controls">
    <div class="cc-row"><span class="cc-lbl">Taille</span><input id="crop-size" type="range" min="0.45" max="0.95" step="0.01" value="0.78"></div>
    <div class="cc-row"><span class="cc-lbl">Zoom</span><input id="crop-zoom" type="range" min="1" max="2.4" step="0.01" value="1"></div>
    <div class="cc-row"><span class="cc-lbl">Lumi√®re</span><input id="crop-brightness" type="range" min="0.7" max="1.4" step="0.01" value="1"></div>
    <div class="cc-row"><span class="cc-lbl">Contraste</span><input id="crop-contrast" type="range" min="0.7" max="1.6" step="0.01" value="1"></div>
    <div class="cc-row"><span class="cc-lbl">Qualit√©</span><input id="crop-quality" type="range" min="0.55" max="1" step="0.01" value="0.88"></div>
    <div class="cc-actions">
      <button class="crop-btn-a" type="button" onclick="cropResetEnhance()">Reset</button>
    </div>
  </div>
  <div class="crop-actions">
    <button class="crop-btn-a" style="background:var(--surface2);color:var(--text);" onclick="closeCrop()">Annuler</button>
    <button class="crop-btn-a" style="background:var(--accent);color:var(--bg);" onclick="applyCrop()">Appliquer</button>
  </div>
</div>
<div class="toast" id="toast"></div>
<script src="assets/app.js"></script>
<script>
/* PAGE: scanner */
document.addEventListener('DOMContentLoaded', ()=>{
  populateYears('f-annee'); populateYears('e-annee');
  loadFromDB();
  updateSportIcon && updateSportIcon();
  initCrop && initCrop();
});
</script>
</body>
</html>
